# OpenSSF Scorecard
# https://securityscorecards.dev
# https://github.com/ossf/scorecard-action

name: Scorecard

on:
    branch_protection_rule:
    schedule:
        - cron: '30 5 * * 1'
    push:
        branches: [main]

permissions: read-all

jobs:
    analysis:
        name: Scorecard analysis
        runs-on: ubuntu-latest

        permissions:
            security-events: write
            id-token: write

        steps:
            - name: Checkout
              uses: actions/checkout@de0fac2e4500dabe0009e67214ff5f5447ce83dd # v6.0.2
              with:
                  persist-credentials: false

            - name: Run analysis
              uses: ossf/scorecard-action@4eaacf0543bb3f2c246792bd56e8cdeffafb205a # v2.4.3
              with:
                  results_file: results.sarif
                  results_format: sarif
                  publish_results: true

            - name: Upload to code-scanning
              uses: github/codeql-action/upload-sarif@19b2f06db2b6f5108140aeb04014ef02b648f789 # v4.31.11
              with:
                  sarif_file: results.sarif
